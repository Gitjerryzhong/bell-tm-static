<ng-container *ngIf="form">
    <div class="btn-toolbar">
        <div class="btn-group ml-auto">
            <button class='btn btn-secondary' (click)="cancel()">取消</button>
            <button class='btn btn-primary' (click)="save()" [disabled]="saving || !form.isValid()">保存</button>
        </div>
    </div>
    <form-title>{{form.title}}</form-title>
    <div class="row">
        <div class="col-md-9">
            <form class="form-horizontal">
                <form-field label="请假类型">
                    <div class="form-check form-check-inline" *ngFor="let leaveType of leaveTypes" >
                        <label class="form-check-label">
                            <input class="form-check-input" type="radio" name="leaveType" [value]="leaveType.type" [(ngModel)]="form.type">
                            {{leaveType.label}}
                        </label>
                    </div>
                </form-field>
                <form-field label="请假事由">
                    <textarea class="form-control" name="reason" rows="4"
                        [(ngModel)]="form.reason"
                        maxlength="200" minlength="10"
                        required
                        #reason="ngModel"></textarea>
                    <p class="form-control-feedback" [hidden]="reason.pristine || reason.valid">
                        <span *ngIf="reason.errors?.required">请假事由不能为空。</span>
                        <span *ngIf="reason.errors?.minlength">请假事由最少{{reason.errors.minlength.requiredLength}}个字符。</span>
                        <span *ngIf="reason.errors?.maxlength">请假事由最多{{reason.errors.maxlength.requiredLength}}个字符。</span>
                    </p>
                </form-field>
            </form>
            <here-schedule *ngIf="schedules" [term]="term" [schedules]="schedules" size="sm">
                <template #weekTabTpl let-week="week">
                    {{week}}<ng-container *ngIf="form.containsWeek(week)">*</ng-container>
                </template>
                <template #weekTpl let-week="week">
                    <button class="btn w-100"
                            [ngClass]="form.weekSelected(week) ? 'btn-warning' : 'btn-secondary'"
                            [disabled]="form.weekDisabled(week)"
                            (click)="form.toggleWeek(week)">
                        <span>第{{week}}周</span>
                    </button>
                </template>
                <template #dayOfWeekTpl let-week="week" let-day="day">
                    <button class="btn w-100"
                            [ngClass]="form.dayOfWeekSelected(week, day) ? 'btn-info' : 'btn-secondary'"
                            [disabled]="form.dayOfWeekDisabled(week, day)"
                            (click)="form.toggleDayOfWeek(week, day)">
                        <span>{{day | dayOfWeek}}</span>
                    </button>
                </template>
                <template #scheduleTpl let-schedule="schedule" let-week="week", let-day="day" let-section="section" let-count="count">
                    <button class="btn w-100"
                            title="{{schedule.startWeek}}-{{schedule.endWeek}}{{schedule.oddEven | oddEven}}周&#013;{{schedule.place}}"
                            [ngClass]="form.scheduleSelected(week, schedule) ? 'btn-success' : 'btn-secondary'"
                            [style.height]="count > 1 ? 'inherit' : '100%'"
                            [disabled]="form.scheduleDisabled(week, schedule)"
                            (click)="form.toggleSchedule(week, schedule)">
                        <span>{{schedule.course}}<ng-container *ngIf="schedule.courseItem"><br>【{{schedule.courseItem}}】</ng-container></span>
                    </button>
                </template>
            </here-schedule>
        </div>
        <div class="col-md-3">
            <ul>
                <li *ngFor="let item of form.items">{{item}}</li>
            </ul>
        </div>
    </div>
</ng-container>
